<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

<title>class OptionList - RDoc Documentation</title>

<link type="text/css" media="screen" href="./rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
</script>

<script type="text/javascript" charset="utf-8" src="./js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/darkfish.js"></script>


<body id="top" class="class">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="./index.html">Home</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  
<div id="table-of-contents">
  <nav class="section">
    <h3 class="section-header">Table of Contents</h3>
    <ul>
      <li><a href="#label-The+file+option_list.rb+and+the+class+OptionList.">The file option_list.rb and the class OptionList.</a>
      <li><a href="#label-Warning%3A+This+code+is+most+opinionated%21+%3B-%29">Warning: This code is most opinionated! ;-)</a>
      <li><a href="#label-Version+1.0.1">Version 1.0.1</a>
      <li><a href="#label-Version+1.1.0">Version 1.1.0</a>
    </ul>
  </nav>
</div>


  <div id="file-metadata">
    <nav id="file-list-section" class="section">
  <h3 class="section-header">Defined In</h3>
  <ul>
    <li>lib/option_list.rb
  </ul>
</nav>

    
  </div>

  <div id="class-metadata">
    
    <nav id="parent-class-section" class="section">
  <h3 class="section-header">Parent</h3>
  
  <p class="link">Object
  
</nav>

    
    
    <!-- Method Quickref -->
<nav id="method-list-section" class="section">
  <h3 class="section-header">Methods</h3>

  <ul class="link-list">
    
    <li ><a href="#method-c-new">::new</a>
    
    <li ><a href="#method-c-version">::version</a>
    
    <li ><a href="#method-i-array_spec">#array_spec</a>
    
    <li ><a href="#method-i-fAE">#fAE</a>
    
    <li ><a href="#method-i-hash_selections">#hash_selections</a>
    
    <li ><a href="#method-i-hash_spec">#hash_spec</a>
    
    <li ><a href="#method-i-select">#select</a>
    
    <li ><a href="#method-i-symbolic_selection">#symbolic_selection</a>
    
    <li ><a href="#method-i-value_entry">#value_entry</a>
    
    <li ><a href="#method-i-version">#version</a>
    
  </ul>
</nav>

  </div>

  <div id="project-metadata">
    <nav id="fileindex-section" class="section project-section">
  <h3 class="section-header">Pages</h3>

  <ul>
  
    <li class="file"><a href="./license_txt.html">license</a>
  
  </ul>
</nav>

    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="./OptionList.html">OptionList</a>
  
    <li><a href="./OptionListTester.html">OptionListTester</a>
  
    <li><a href="./OptionTest.html">OptionTest</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation">
  <h1 class="class">class OptionList</h1>

  <div id="description" class="description">
    
<h3 id="label-The+file+option_list.rb+and+the+class+OptionList.">The file option_list.rb and the class OptionList.<span><a href="#label-The+file+option_list.rb+and+the+class+OptionList.">&para;</a> <a href="#documentation">&uarr;</a></span></h3>

<p>This file contains the code for the OptionList class that implements smart
and easy options for functions. It has the virtue of defining function
options clearly in a single place instead of spread out in complex code. A
classic but unclear sequence in many functions is the use of boolean values
to control or switch on or off some option. For example consider the well 
known readline function:</p>

<pre>cmd = readline(&quot;&gt;&quot;, false)</pre>

<p>See the boolean at the end? It says “false”. What is “false”? Who knows?
You  need to dig deeper or guess or just cut and paste without
understanding. What if, instead, the code looked like:</p>

<pre>cmd = readline(&quot;&gt;&quot;, :nohistory)</pre>

<p>The boolean has been replaced by something a lot clearer. The problem with
such clarity is that it involves a lot more effort than the lazy boolean.
The OptionList class aims to solve that issue by making useful, flexible
options just about as easy to use as the lazy way.</p>

<h4 id="label-Warning%3A+This+code+is+most+opinionated%21+%3B-%29">Warning: This code is most opinionated! ;-)<span><a href="#label-Warning%3A+This+code+is+most+opinionated%21+%3B-%29">&para;</a> <a href="#documentation">&uarr;</a></span></h4>

<p>The philosophy and opinion expressed through this code is that errors
should be detected as close to the point of error as possible and that an
error is preferable to running with potentially incorrect results. As a
result, it will be noted that the programmer does not hesitate to use the
fAE, a wrapper of the “fail” keyword, liberally throughout the code to
achieve this end. Complimentary to this is the idea that the library (gem)
writer should do as much of the “heavy lifting” as possible, with clear,
detailed documentation so that the library (gem) user does not have to work
hard or be lost or confused. Only time will tell to what extent these lofty
goals have been achieved.  Hopefully, with good feedback, this and other
code libraries will improve.</p>

<h3 id="label-Version+1.0.1">Version 1.0.1<span><a href="#label-Version+1.0.1">&para;</a> <a href="#documentation">&uarr;</a></span></h3>

<p>This version represents a major overhaul of the OptionList class. In 
particular, the selected option data and the dynamic methods used to access
that data are no longer contained in the option list object but instead in
a singleton subclass of Hash that is returned by the select method. There 
are several advantages to this, but the main one is that since OptionList
objects now only contain specification and default values, they are much
more thread safe than before. While there is nothing multi-threaded about
the OptionList class itself, it is reasonable to assume that a function
option handler could very easily end up embedded in such an environment. In
fact, my first major test of the class ran into this exact issue.</p>

<h3 id="label-Version+1.1.0">Version 1.1.0<span><a href="#label-Version+1.1.0">&para;</a> <a href="#documentation">&uarr;</a></span></h3>

<p>Added a default value of false to signify that no default exists for a 
mandatory parameter. Modified processing of array specs to avoid side
effects in the parameters.</p>

  </div><!-- description -->

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    <!-- Methods -->
    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Class Methods</h3>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(*option_specs, &select_block)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Create an option list from an array of option specifications. These 
specifications consist of a number of array specifications and hash 
specifications. These are described below:</p>

<h4 id="method-c-new-label-Array+Specification">Array Specification<span><a href="#method-c-new-label-Array+Specification">&para;</a> <a href="#documentation">&uarr;</a></span></h4>

<p>Array specifications are used in cases where an option category may be one
of a fixed number of distinct symbol values or optionally nil to represent 
no selection. In this form of specification, the first element of the array
is the category of the option, and the second and following entries are the
allowed values for that category. The second element has a special role. It
is the default value for the category. This value may be one of:</p>
<ul><li>
<p>A symbol - The default symbolic value for this option.</p>
</li><li>
<p>nil - The default value is nil and this setting is optional.</p>
</li><li>
<p>false - There is no default value and this setting is mandatory.</p>
</li></ul>

<p>The symbols used in each category must be unique across all of the
categories in the option list.</p>

<h4 id="method-c-new-label-Hash+Specification">Hash Specification<span><a href="#method-c-new-label-Hash+Specification">&para;</a> <a href="#documentation">&uarr;</a></span></h4>

<p>Hash specifications are used to specify options that do not have a fixed
set of possible values. In this form of specification, the hash key symbol
is  the category and the hash value is the default value for the category.
It  may be nil or any other type or value. Allowed values are not listed.</p>

<h4 id="method-c-new-label-Example%3A">Example:<span><a href="#method-c-new-label-Example%3A">&para;</a> <a href="#documentation">&uarr;</a></span></h4>

<pre class="ruby"><span class="ruby-ivar">@opt_list</span> = <span class="ruby-constant">OptionList</span>.<span class="ruby-identifier">new</span>([:<span class="ruby-identifier">history</span>, :<span class="ruby-identifier">history</span>, :<span class="ruby-identifier">nohistory</span>], {:<span class="ruby-identifier">page_len</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">42</span>})
</pre>

<h4 id="method-c-new-label-Parameters%3A">Parameters:<span><a href="#method-c-new-label-Parameters%3A">&para;</a> <a href="#documentation">&uarr;</a></span></h4>
<ul><li>
<p>option_specs - The comma separated option specifications, made into an 
array by the splat operator.</p>
</li><li>
<p>select_block - An optional block of code that is called when selections
have been made. This allows for custom validations to be applied at that
point. This block should accept one argument, a reference to the option
list value object that is calling it for validation.</p>
</li></ul>

<h4 id="method-c-new-label-Dynamic+Methods%3A">Dynamic Methods:<span><a href="#method-c-new-label-Dynamic+Methods%3A">&para;</a> <a href="#documentation">&uarr;</a></span></h4>

<p>As option specifications are added, new methods are created in the value 
object to allow for easy access to the option information. If the above 
example were processed, the following methods would be added to the value
returned by the select method:</p>
<ul><li>
<p>history - would return the value of the :history category.</p>
</li><li>
<p>history? - would return true if the :history option where active.</p>
</li><li>
<p>nohistory? - would return true if the :nohistory option were active.</p>
</li><li>
<p>page_len - would return the value of the :page_len category.</p>
</li></ul>

<h4 id="method-c-new-label-Exceptions%3A">Exceptions:<span><a href="#method-c-new-label-Exceptions%3A">&para;</a> <a href="#documentation">&uarr;</a></span></h4>
<ul><li>
<p>ArgumentError for a number of invalid argument conditions.</p>
</li></ul>
          
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/option_list.rb, line 98</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">option_specs</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">select_block</span>)
  <span class="ruby-identifier">fAE</span> <span class="ruby-string">&quot;Missing option specifications.&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">option_specs</span>.<span class="ruby-identifier">empty?</span>
  <span class="ruby-ivar">@mandatory</span>  = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-ivar">@categories</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-ivar">@default</span>    = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>
  
  <span class="ruby-identifier">option_specs</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">spec</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)
      <span class="ruby-identifier">hash_spec</span>(<span class="ruby-identifier">spec</span>)
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
      <span class="ruby-identifier">array_spec</span>(<span class="ruby-identifier">spec</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">fAE</span> <span class="ruby-node">&quot;Found #{spec.class} instead of Hash or Array.&quot;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  
  <span class="ruby-ivar">@select_block</span> = <span class="ruby-identifier">select_block</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- new-source -->
          
        </div>

        

        
      </div><!-- new-method -->

    
      <div id="method-c-version" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">version</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>The option list code version.</p>
          
          

          
          <div class="method-source-code" id="version-source">
            <pre><span class="ruby-comment"># File lib/option_list.rb, line 48</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">version</span>
  <span class="ruby-string">'1.1.0'</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- version-source -->
          
        </div>

        

        
      </div><!-- version-method -->

    
    </section><!-- public-class-method-details -->
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Instance Methods</h3>

    
      <div id="method-i-select" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">select</span><span
            class="method-args">(selections=[])</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>From the possible options, select the actual, in force, options and return
an access object for use in the code. These options may take several forms:</p>

<h3 id="method-i-select-label-Types+of+option+data%3A">Types of option data:<span><a href="#method-i-select-label-Types+of+option+data%3A">&para;</a> <a href="#documentation">&uarr;</a></span></h3>
<ul><li>
<p>A symbol - For categories with a specified symbol list, simply list one of
the allowed symbols.</p>
</li><li>
<p>A hash - For any type of category, a hash may be used in the the form
{category =&gt; value}. Note that for categories with a specified symbol
list the value must be a symbol in the list.</p>
</li><li>
<p>Mixed - Symbols and hashes can be mixed in an array (see below on how this
is done) Note: Option order does not matter.</p>
</li></ul>

<p>Some examples:</p>

<pre class="ruby"><span class="ruby-identifier">o</span> = <span class="ruby-identifier">foo</span>(:<span class="ruby-identifier">sedan</span>, :<span class="ruby-identifier">turbo</span>)
<span class="ruby-identifier">o</span> = <span class="ruby-identifier">foo</span>({:<span class="ruby-identifier">style=</span><span class="ruby-operator">&gt;</span>:<span class="ruby-identifier">sedan</span>})
<span class="ruby-identifier">o</span> = <span class="ruby-identifier">foo</span>(<span class="ruby-identifier">page_len</span><span class="ruby-operator">:</span> <span class="ruby-value">60</span>) 
<span class="ruby-identifier">o</span> = <span class="ruby-identifier">foo</span>(:<span class="ruby-identifier">sedan</span>, :<span class="ruby-identifier">turbo</span>, <span class="ruby-identifier">page_len</span><span class="ruby-operator">:</span> <span class="ruby-value">60</span>)
<span class="ruby-identifier">o</span> = <span class="ruby-identifier">foo</span>(<span class="ruby-identifier">style</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">sedan</span>, <span class="ruby-identifier">page_len</span><span class="ruby-operator">:</span> <span class="ruby-value">60</span>)
</pre>

<h3 id="method-i-select-label-Passing+in+option+data%3A">Passing in option data:<span><a href="#method-i-select-label-Passing+in+option+data%3A">&para;</a> <a href="#documentation">&uarr;</a></span></h3>

<p>The caller of this method may pass these options in a number of ways:</p>

<h4 id="method-i-select-label-Array+%28via+a+splat%29">Array (via a splat)<span><a href="#method-i-select-label-Array+%28via+a+splat%29">&para;</a> <a href="#documentation">&uarr;</a></span></h4>

<p>Given the example shown in the new method, consider:</p>

<pre class="ruby"><span class="ruby-keyword">def</span> <span class="ruby-identifier">test</span>(<span class="ruby-identifier">count</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">opt</span>)
  <span class="ruby-ivar">@opt_list</span>.<span class="ruby-identifier">select</span>(<span class="ruby-identifier">opt</span>)
  <span class="ruby-comment">#etc, etc, etc...</span>
<span class="ruby-keyword">end</span>
</pre>

<p>With the caller now looking like:</p>

<pre>test(43, :history)</pre>

<h4 id="method-i-select-label-Array+%28explicit%29">Array (explicit)<span><a href="#method-i-select-label-Array+%28explicit%29">&para;</a> <a href="#documentation">&uarr;</a></span></h4>

<p>An alternative strategy, where the use of splat is not desired, is to
simply have an array argument, as below:</p>

<pre class="ruby"><span class="ruby-keyword">def</span> <span class="ruby-identifier">test</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">arg1</span>, <span class="ruby-identifier">opt</span>)
  <span class="ruby-ivar">@opt_list</span>.<span class="ruby-identifier">select</span>(<span class="ruby-identifier">opt</span>)
  <span class="ruby-comment">#etc, etc, etc...</span>
<span class="ruby-keyword">end</span>
</pre>

<p>With the caller now looking like:</p>

<pre>test(34, 53, 76, 'hike!', [:history])</pre>

<h4 id="method-i-select-label-Hash">Hash<span><a href="#method-i-select-label-Hash">&para;</a> <a href="#documentation">&uarr;</a></span></h4>

<p>Options may also be passed via a hash.</p>

<pre class="ruby"><span class="ruby-identifier">test</span>(<span class="ruby-value">34</span>, <span class="ruby-value">53</span>, <span class="ruby-value">76</span>, <span class="ruby-string">'hike!'</span>, {:<span class="ruby-identifier">history=</span><span class="ruby-operator">&gt;</span>:<span class="ruby-identifier">history</span>, :<span class="ruby-identifier">page_len=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">55</span>})
<span class="ruby-identifier">test</span>(<span class="ruby-value">34</span>, <span class="ruby-value">53</span>, <span class="ruby-value">76</span>, <span class="ruby-string">'hike!'</span>, <span class="ruby-identifier">history</span><span class="ruby-operator">:</span> :<span class="ruby-identifier">history</span>, <span class="ruby-identifier">page_len</span><span class="ruby-operator">:</span> <span class="ruby-value">55</span>)
</pre>

<h4 id="method-i-select-label-Symbol">Symbol<span><a href="#method-i-select-label-Symbol">&para;</a> <a href="#documentation">&uarr;</a></span></h4>

<p>If only a single option is required, it can be passed simply as:</p>

<pre>test(34, 53, 76, 'hike!', :history)</pre>

<h4 id="method-i-select-label-Parameters%3A">Parameters:<span><a href="#method-i-select-label-Parameters%3A">&para;</a> <a href="#documentation">&uarr;</a></span></h4>
<ul><li>
<p>selections - An array of the options passed into the client function,
usually with the splat operator. Note that if select is called with no
arguments, all of the default values will be selected.</p>
</li></ul>

<h4 id="method-i-select-label-Returns%3A">Returns:<span><a href="#method-i-select-label-Returns%3A">&para;</a> <a href="#documentation">&uarr;</a></span></h4>

<p>An option value object which is a singleton subclass of the Hash class.</p>

<h4 id="method-i-select-label-Exceptions%3A">Exceptions:<span><a href="#method-i-select-label-Exceptions%3A">&para;</a> <a href="#documentation">&uarr;</a></span></h4>
<ul><li>
<p>ArgumentError for a number of invalid argument conditions.</p>
</li></ul>

<h4 id="method-i-select-label-Notes%3A">Notes:<span><a href="#method-i-select-label-Notes%3A">&para;</a> <a href="#documentation">&uarr;</a></span></h4>

<p>After processing the selections, the selection validation block is called 
if one was defined for the constructor.</p>
          
          

          
          <div class="method-source-code" id="select-source">
            <pre><span class="ruby-comment"># File lib/option_list.rb, line 170</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">select</span>(<span class="ruby-identifier">selections</span>=[])
  <span class="ruby-identifier">selected</span> = <span class="ruby-ivar">@default</span>.<span class="ruby-identifier">clone</span>
  <span class="ruby-identifier">selections</span> = [<span class="ruby-identifier">selections</span>] <span class="ruby-keyword">unless</span> <span class="ruby-identifier">selections</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
  <span class="ruby-identifier">dup</span> = <span class="ruby-constant">Set</span>.<span class="ruby-identifier">new</span>

  <span class="ruby-identifier">selections</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">opt</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">opt</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Symbol</span>)
      <span class="ruby-identifier">symbolic_selection</span>(<span class="ruby-identifier">opt</span>, <span class="ruby-identifier">selected</span>, <span class="ruby-identifier">dup</span>)
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">opt</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)
      <span class="ruby-identifier">hash_selections</span>(<span class="ruby-identifier">opt</span>, <span class="ruby-identifier">selected</span>, <span class="ruby-identifier">dup</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">fAE</span> <span class="ruby-node">&quot;Found #{opt.class} instead of Hash or Symbol.&quot;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  
  <span class="ruby-ivar">@mandatory</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">cat</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">fAE</span> <span class="ruby-node">&quot;Missing mandatory setting #{cat}&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">selected</span>[<span class="ruby-identifier">cat</span>]
  <span class="ruby-keyword">end</span>
  
  <span class="ruby-ivar">@select_block</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">selected</span>) <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@select_block</span>.<span class="ruby-identifier">nil?</span>
  <span class="ruby-identifier">selected</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- select-source -->
          
        </div>

        

        
      </div><!-- select-method -->

    
      <div id="method-i-version" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">version</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>The option list code version. This is a redirect to the class method.</p>
          
          

          
          <div class="method-source-code" id="version-source">
            <pre><span class="ruby-comment"># File lib/option_list.rb, line 53</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">version</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">version</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- version-source -->
          
        </div>

        

        
      </div><!-- version-method -->

    
    </section><!-- public-instance-method-details -->
  
     <section id="private-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Private Instance Methods</h3>

    
      <div id="method-i-array_spec" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">array_spec</span><span
            class="method-args">(spec)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Process an array spec that lists all the valid values for an option. See
the new method for more information on these specs.</p>
          
          

          
          <div class="method-source-code" id="array_spec-source">
            <pre><span class="ruby-comment"># File lib/option_list.rb, line 202</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">array_spec</span>(<span class="ruby-identifier">spec</span>)
  <span class="ruby-identifier">cat</span> = <span class="ruby-identifier">spec</span>[<span class="ruby-value">0</span>]
  <span class="ruby-identifier">spec</span> = <span class="ruby-identifier">spec</span>[<span class="ruby-value">1</span><span class="ruby-operator">...</span><span class="ruby-identifier">spec</span>.<span class="ruby-identifier">length</span>]
  
  <span class="ruby-identifier">fAE</span> <span class="ruby-node">&quot;Found #{cat.class}, expected Symbol.&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">cat</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Symbol</span>)   
  <span class="ruby-identifier">fAE</span> <span class="ruby-node">&quot;Duplicate category: #{cat}&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@default</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">cat</span>)
  <span class="ruby-identifier">fAE</span> <span class="ruby-node">&quot;Invalid number of entries for #{cat}.&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>
  <span class="ruby-ivar">@default</span>.<span class="ruby-identifier">define_singleton_method</span>(<span class="ruby-identifier">cat</span>) { <span class="ruby-keyword">self</span>[<span class="ruby-identifier">cat</span>] }
  
  <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">opt</span>, <span class="ruby-identifier">index</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">opt</span>
      <span class="ruby-identifier">fAE</span> <span class="ruby-node">&quot;Found #{opt.class}, expected Symbol.&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">opt</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Symbol</span>)   
      <span class="ruby-identifier">fAE</span> <span class="ruby-node">&quot;Duplicate option: #{opt}&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@categories</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">opt</span>)
      
      <span class="ruby-ivar">@categories</span>[<span class="ruby-identifier">opt</span>] = <span class="ruby-identifier">cat</span>
      <span class="ruby-identifier">qry</span> = (<span class="ruby-identifier">opt</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">'?'</span>).<span class="ruby-identifier">to_sym</span>
      <span class="ruby-ivar">@default</span>.<span class="ruby-identifier">define_singleton_method</span>(<span class="ruby-identifier">qry</span>) { <span class="ruby-keyword">self</span>[<span class="ruby-identifier">cat</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">opt</span> }
      <span class="ruby-ivar">@default</span>[<span class="ruby-identifier">cat</span>] = <span class="ruby-identifier">opt</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">index</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">index</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
      <span class="ruby-ivar">@default</span>[<span class="ruby-identifier">cat</span>] = <span class="ruby-identifier">opt</span>
      <span class="ruby-ivar">@mandatory</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">cat</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">opt</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">false</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">fAE</span> <span class="ruby-string">&quot;The values nil/false are only allowed as the default option.&quot;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- array_spec-source -->
          
        </div>

        

        
      </div><!-- array_spec-method -->

    
      <div id="method-i-fAE" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">fAE</span><span
            class="method-args">(msg)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Fail with an argument error.</p>
          
          

          
          <div class="method-source-code" id="fAE-source">
            <pre><span class="ruby-comment"># File lib/option_list.rb, line 278</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">fAE</span>(<span class="ruby-identifier">msg</span>)
  <span class="ruby-identifier">fail</span>(<span class="ruby-constant">ArgumentError</span>, <span class="ruby-identifier">msg</span>, <span class="ruby-identifier">caller</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- fAE-source -->
          
        </div>

        

        
      </div><!-- fAE-method -->

    
      <div id="method-i-hash_selections" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">hash_selections</span><span
            class="method-args">(options, selected, dup)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Process a hash of option selection values.</p>

<h4 id="method-i-hash_selections-label-Parameters%3A">Parameters:<span><a href="#method-i-hash_selections-label-Parameters%3A">&para;</a> <a href="#documentation">&uarr;</a></span></h4>
<ul><li>
<p>options - a hash of options to process.</p>
</li><li>
<p>selected - a hash of selected data.</p>
</li><li>
<p>dup - a set of categories that have been set. Used to detect duplicates.</p>
</li></ul>
          
          

          
          <div class="method-source-code" id="hash_selections-source">
            <pre><span class="ruby-comment"># File lib/option_list.rb, line 262</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">hash_selections</span>(<span class="ruby-identifier">options</span>, <span class="ruby-identifier">selected</span>, <span class="ruby-identifier">dup</span>)
  <span class="ruby-identifier">options</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">cat</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">fAE</span> <span class="ruby-node">&quot;Not a category: #{cat}.&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@default</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">cat</span>)
    <span class="ruby-identifier">fAE</span> <span class="ruby-node">&quot;Category #{cat} has multiple values.&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">dup</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">cat</span>)
         
    <span class="ruby-keyword">unless</span> (<span class="ruby-ivar">@categories</span>[<span class="ruby-identifier">cat</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">value_entry</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span>
      <span class="ruby-identifier">fAE</span> <span class="ruby-node">&quot;Found #{opt.class}, expected Symbol.&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Symbol</span>)
      <span class="ruby-identifier">fAE</span> <span class="ruby-node">&quot;Invalid option: #{value}.&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@categories</span>[<span class="ruby-identifier">value</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">cat</span>
    <span class="ruby-keyword">end</span>
    
    <span class="ruby-identifier">dup</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">cat</span>)
    <span class="ruby-identifier">selected</span>[<span class="ruby-identifier">cat</span>] = <span class="ruby-identifier">value</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- hash_selections-source -->
          
        </div>

        

        
      </div><!-- hash_selections-method -->

    
      <div id="method-i-hash_spec" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">hash_spec</span><span
            class="method-args">(spec)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Process a hash spec that lists only the default value for an option. See
the new method for more information on these specs.</p>
          
          

          
          <div class="method-source-code" id="hash_spec-source">
            <pre><span class="ruby-comment"># File lib/option_list.rb, line 231</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">hash_spec</span>(<span class="ruby-identifier">spec</span>)
  <span class="ruby-identifier">fAE</span> <span class="ruby-string">&quot;Hash contains no specs.&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>

  <span class="ruby-identifier">spec</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">cat</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">fAE</span> <span class="ruby-node">&quot;Found #{cat.class}, expected Symbol.&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">cat</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Symbol</span>)    
    <span class="ruby-identifier">fAE</span> <span class="ruby-node">&quot;Duplicate category: #{cat}&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@default</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">cat</span>)
    
    <span class="ruby-ivar">@default</span>.<span class="ruby-identifier">define_singleton_method</span>(<span class="ruby-identifier">cat</span>) { <span class="ruby-keyword">self</span>[<span class="ruby-identifier">cat</span>] }
    <span class="ruby-ivar">@categories</span>[<span class="ruby-identifier">cat</span>] = <span class="ruby-identifier">value_entry</span>
    <span class="ruby-ivar">@default</span>[<span class="ruby-identifier">cat</span>] = <span class="ruby-identifier">value</span>    
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- hash_spec-source -->
          
        </div>

        

        
      </div><!-- hash_spec-method -->

    
      <div id="method-i-symbolic_selection" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">symbolic_selection</span><span
            class="method-args">(option, selected, dup)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Process a symbolic option selection.</p>

<h4 id="method-i-symbolic_selection-label-Parameters%3A">Parameters:<span><a href="#method-i-symbolic_selection-label-Parameters%3A">&para;</a> <a href="#documentation">&uarr;</a></span></h4>
<ul><li>
<p>option - a symbol to process.</p>
</li><li>
<p>selected - a hash of selected data.</p>
</li><li>
<p>dup - a set of categories that have been set. Used to detect duplicates.</p>
</li></ul>
          
          

          
          <div class="method-source-code" id="symbolic_selection-source">
            <pre><span class="ruby-comment"># File lib/option_list.rb, line 249</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">symbolic_selection</span>(<span class="ruby-identifier">option</span>, <span class="ruby-identifier">selected</span>, <span class="ruby-identifier">dup</span>)
  <span class="ruby-identifier">fAE</span> <span class="ruby-node">&quot;Unknown option: #{option}.&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@categories</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">option</span>)
  <span class="ruby-identifier">cat</span> = <span class="ruby-ivar">@categories</span>[<span class="ruby-identifier">option</span>]
  <span class="ruby-identifier">fAE</span> <span class="ruby-node">&quot;Category #{cat} has multiple values.&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">dup</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">cat</span>)
  <span class="ruby-identifier">dup</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">cat</span>)
  <span class="ruby-identifier">selected</span>[<span class="ruby-identifier">cat</span>] = <span class="ruby-identifier">option</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- symbolic_selection-source -->
          
        </div>

        

        
      </div><!-- symbolic_selection-method -->

    
      <div id="method-i-value_entry" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">value_entry</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Return a internal category marker constant for value entries.</p>
          
          

          
          <div class="method-source-code" id="value_entry-source">
            <pre><span class="ruby-comment"># File lib/option_list.rb, line 196</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">value_entry</span>
  <span class="ruby-string">'A value entry.'</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- value_entry-source -->
          
        </div>

        

        
      </div><!-- value_entry-method -->

    
    </section><!-- private-instance-method-details -->
  
  </section><!-- 5Buntitled-5D -->

</div><!-- documentation -->


<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 4.0.1.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

